<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üè≠ Face Recognition System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .control-panel {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .controls-row {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .control-group label {
            font-weight: 600;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        select, input, button {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        select, input {
            background: rgba(255,255,255,0.9);
            color: #333;
            min-width: 150px;
        }

        select:focus, input:focus {
            outline: none;
            box-shadow: 0 0 15px rgba(255,255,255,0.5);
            transform: scale(1.02);
        }

        button {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            cursor: pointer;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            min-width: 120px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        button:active {
            transform: translateY(0);
        }

        button.stop-btn {
            background: linear-gradient(45deg, #f44336, #d32f2f);
        }

        button.load-btn {
            background: linear-gradient(45deg, #2196F3, #1976D2);
        }

        .status {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
        }

        .main-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
        }

        .video-section {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .video-container {
            position: relative;
            background: #000;
            border-radius: 10px;
            overflow: hidden;
            aspect-ratio: 16/9;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #camera-feed {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .video-placeholder {
            color: #666;
            font-size: 1.5em;
            text-align: center;
        }

        .info-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .info-panel {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .info-panel h3 {
            margin-bottom: 15px;
            color: #fff;
            border-bottom: 2px solid rgba(255,255,255,0.3);
            padding-bottom: 8px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .stat-item {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.8;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .detection-list {
            max-height: 300px;
            overflow-y: auto;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            padding: 10px;
        }

        .detection-item {
            padding: 10px;
            margin-bottom: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 6px;
            border-left: 4px solid #4CAF50;
        }

        .detection-name {
            font-weight: bold;
            margin-bottom: 3px;
        }

        .detection-details {
            font-size: 0.85em;
            opacity: 0.8;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Tab Navigation Styles */
        .tab-navigation {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 10px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .tab-btn {
            padding: 15px 30px;
            margin: 0 10px;
            background: rgba(255,255,255,0.1);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .tab-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        .tab-btn.active {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Upload Employee Styles */
        .upload-section {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .upload-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .upload-method {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.1);
            text-align: center;
        }

        .upload-method h4 {
            margin-bottom: 15px;
            color: #4CAF50;
        }

        .file-input {
            display: none;
        }

        .file-label {
            display: inline-block;
            padding: 12px 24px;
            background: linear-gradient(45deg, #2196F3, #1976D2);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin: 10px;
            transition: all 0.3s ease;
        }

        .file-label:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.4);
        }

        /* CRUD Operations Styles */
        .crud-nav {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .crud-btn {
            padding: 10px 20px;
            background: linear-gradient(45deg, #607D8B, #455A64);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .crud-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(96, 125, 139, 0.4);
        }

        .crud-btn.active {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
        }

        .crud-section {
            display: none;
        }

        .crud-section.active {
            display: block;
        }

        .employee-list {
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
        }

        .employee-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid #eee;
            transition: background 0.3s ease;
        }

        .employee-item:hover {
            background: rgba(33, 150, 243, 0.1);
        }

        .employee-info {
            flex: 1;
        }

        .employee-actions {
            display: flex;
            gap: 5px;
        }

        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .action-btn.edit {
            background: linear-gradient(45deg, #FF9800, #F57C00);
            color: white;
        }

        .action-btn.delete {
            background: linear-gradient(45deg, #f44336, #d32f2f);
            color: white;
        }

        .action-btn.toggle {
            background: linear-gradient(45deg, #9E9E9E, #757575);
            color: white;
        }

        .action-btn.active {
            background: linear-gradient(45deg, #4CAF50, #45a049);
        }

        .action-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(0,0,0,0.3);
        }

        .search-results {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            min-height: 100px;
        }

        .edit-form {
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .form-group {
            flex: 1;
            min-width: 200px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #2196F3;
            box-shadow: 0 0 5px rgba(33, 150, 243, 0.3);
        }

        .status-active {
            color: #4CAF50;
            font-weight: bold;
        }

        .status-disabled {
            color: #f44336;
            font-weight: bold;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
            font-style: italic;
        }

        .photo-previews {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
            padding: 10px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
        }

        .photo-preview {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            object-fit: cover;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .employee-form {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 5px;
            font-weight: 600;
        }

        .form-group input {
            padding: 10px;
            border: none;
            border-radius: 5px;
            background: rgba(255,255,255,0.9);
            color: #333;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.2);
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #4CAF50, #45a049);
            width: 0%;
            transition: width 0.3s ease;
        }

        .hidden {
            display: none;
        }

        .success {
            color: #4CAF50;
        }

        .error {
            color: #f44336;
        }

        .warning {
            color: #ff9800;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .controls-row {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè≠ Face Recognition System</h1>
            <p>Real-time Employee Detection with Camera Switching</p>
        </div>

        <div class="control-panel">
            <div class="controls-row">
                <div class="control-group">
                    <label>üìπ Camera Type</label>
                    <select id="camera-type">
                        <option value="webcam">Webcam</option>
                        <option value="cctv1">CCTV System 1 (127 Channels - Old)</option>
                        <option value="cctv2">CCTV System 2 (128 Channels - New)</option>
                        <option value="cctv">CCTV (Default/Auto)</option>
                    </select>
                </div>

                <div class="control-group" id="channel-group">
                    <label>üì∫ CCTV Channel (1-128)</label>
                    <input type="number" id="cctv-channel" min="1" max="128" value="1" placeholder="Enter channel (1-128)">
                </div>

                <div class="control-group" style="display: none;" id="old-channel-group">
                    <label>üì∫ CCTV Channel</label>
                    <select id="cctv-channel-select">
                        <option value="1">Channel 1</option>
                        <option value="2">Channel 2</option>
                        <option value="3">Channel 3</option>
                        <option value="4">Channel 4</option>
                        <option value="5">Channel 5</option>
                        <option value="6">Channel 6</option>
                        <option value="7">Channel 7</option>
                        <option value="8">Channel 8</option>
                        <option value="9">Channel 9</option>
                        <option value="10">Channel 10</option>
                        <option value="11">Channel 11</option>
                        <option value="12">Channel 12</option>
                        <option value="13">Channel 13</option>
                        <option value="14">Channel 14</option>
                        <option value="15">Channel 15</option>
                        <option value="16">Channel 16</option>
                        <option value="17">Channel 17</option>
                        <option value="18">Channel 18</option>
                        <option value="19">Channel 19</option>
                        <option value="20">Channel 20</option>
                        <option value="21">Channel 21</option>
                        <option value="22">Channel 22</option>
                        <option value="23">Channel 23</option>
                        <option value="24">Channel 24</option>
                        <option value="25">Channel 25</option>
                        <option value="26">Channel 26</option>
                        <option value="27">Channel 27</option>
                        <option value="28">Channel 28</option>
                        <option value="29">Channel 29</option>
                        <option value="30">Channel 30</option>
                        <option value="31">Channel 31</option>
                        <option value="32">Channel 32</option>
                        <option value="33">Channel 33</option>
                        <option value="34">Channel 34</option>
                        <option value="35">Channel 35</option>
                        <option value="36">Channel 36</option>
                        <option value="37">Channel 37</option>
                        <option value="38">Channel 38</option>
                        <option value="39">Channel 39</option>
                        <option value="40">Channel 40</option>
                        <option value="41">Channel 41</option>
                        <option value="42">Channel 42</option>
                        <option value="43">Channel 43</option>
                        <option value="44">Channel 44</option>
                        <option value="45">Channel 45</option>
                        <option value="46">Channel 46</option>
                        <option value="47">Channel 47</option>
                        <option value="48">Channel 48</option>
                        <option value="49">Channel 49</option>
                        <option value="50">Channel 50</option>
                        <option value="51">Channel 51</option>
                        <option value="52">Channel 52</option>
                        <option value="53">Channel 53</option>
                        <option value="54">Channel 54</option>
                        <option value="55">Channel 55</option>
                        <option value="56">Channel 56</option>
                        <option value="57">Channel 57</option>
                        <option value="58">Channel 58</option>
                        <option value="59">Channel 59</option>
                        <option value="60">Channel 60</option>
                        <option value="61">Channel 61</option>
                        <option value="62">Channel 62</option>
                        <option value="63">Channel 63</option>
                        <option value="64">Channel 64</option>
                        <option value="65">Channel 65</option>
                        <option value="66">Channel 66</option>
                        <option value="67">Channel 67</option>
                        <option value="68">Channel 68</option>
                        <option value="69">Channel 69</option>
                        <option value="70">Channel 70</option>
                        <option value="71">Channel 71</option>
                        <option value="72">Channel 72</option>
                        <option value="73">Channel 73</option>
                        <option value="74">Channel 74</option>
                        <option value="75">Channel 75</option>
                        <option value="76">Channel 76</option>
                        <option value="77">Channel 77</option>
                        <option value="78">Channel 78</option>
                        <option value="79">Channel 79</option>
                        <option value="80">Channel 80</option>
                        <option value="81">Channel 81</option>
                        <option value="82">Channel 82</option>
                        <option value="83">Channel 83</option>
                        <option value="84">Channel 84</option>
                        <option value="85">Channel 85</option>
                        <option value="86">Channel 86</option>
                        <option value="87">Channel 87</option>
                        <option value="88">Channel 88</option>
                        <option value="89">Channel 89</option>
                        <option value="90">Channel 90</option>
                        <option value="91">Channel 91</option>
                        <option value="92">Channel 92</option>
                        <option value="93">Channel 93</option>
                        <option value="94">Channel 94</option>
                        <option value="95">Channel 95</option>
                        <option value="96">Channel 96</option>
                        <option value="97">Channel 97</option>
                        <option value="98">Channel 98</option>
                        <option value="99">Channel 99</option>
                        <option value="100">Channel 100</option>
                        <option value="101">Channel 101</option>
                        <option value="102">Channel 102</option>
                        <option value="103">Channel 103</option>
                        <option value="104">Channel 104</option>
                        <option value="105">Channel 105</option>
                        <option value="106">Channel 106</option>
                        <option value="107">Channel 107</option>
                        <option value="108">Channel 108</option>
                        <option value="109">Channel 109</option>
                        <option value="110">Channel 110</option>
                        <option value="111">Channel 111</option>
                        <option value="112">Channel 112</option>
                        <option value="113">Channel 113</option>
                        <option value="114">Channel 114</option>
                        <option value="115">Channel 115</option>
                        <option value="116">Channel 116</option>
                        <option value="117">Channel 117</option>
                        <option value="118">Channel 118</option>
                        <option value="119">Channel 119</option>
                        <option value="120">Channel 120</option>
                        <option value="121">Channel 121</option>
                        <option value="122">Channel 122</option>
                        <option value="123">Channel 123</option>
                        <option value="124">Channel 124</option>
                        <option value="125">Channel 125</option>
                        <option value="126">Channel 126</option>
                        <option value="127">Channel 127</option>
                    </select>
                </div>

                <div class="control-group">
                    <label>‚öôÔ∏è Detection Mode</label>
                    <select id="detection-mode">
                        <option value="normal">üöÄ Normal Mode (Fast - Low CPU)</option>
                        <option value="optimized">üíé Optimized Mode (Accurate - High CPU)</option>
                    </select>
                </div>

                <div class="control-group">
                    <label>üéØ Confidence Settings</label>
                    <div style="display: flex; gap: 15px; align-items: center;">
                        <div>
                            <label style="font-size: 0.85em;">Min Confidence:</label>
                            <input type="range" id="confidence-threshold" min="50" max="80" value="60" style="width: 80px;">
                            <span id="confidence-value" style="color: #4CAF50;">60%</span>
                        </div>
                        <div>
                            <label style="font-size: 0.85em;">Strictness:</label>
                            <select id="strictness-mode" style="padding: 2px 5px; font-size: 0.8em;">
                                <option value="normal">Normal</option>
                                <option value="strict" selected>Strict (Recommended)</option>
                                <option value="very_strict">Very Strict</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="control-group">
                    <label>üìä Performance</label>
                    <div style="display: flex; gap: 15px; font-size: 0.9em;">
                        <span>FPS: <span id="fps-counter" style="color: #4CAF50;">0</span></span>
                        <span>CPU: <span id="cpu-usage" style="color: #FF9800;">Low</span></span>
                        <span>Mode: <span id="current-mode" style="color: #2196F3;">Normal</span></span>
                    </div>
                </div>

                <div class="control-group">
                    <label>üéÆ Actions</label>
                    <div style="display: flex; gap: 10px;">
                        <button id="load-faces" class="load-btn">Load Faces</button>
                        <button id="start-camera">Start Camera</button>
                        <button id="stop-camera" class="stop-btn">Stop Camera</button>
                    </div>
                </div>
                
                <!-- Multi-Camera Section -->
                <div class="control-group" style="border-top: 2px solid rgba(255,255,255,0.2); padding-top: 15px; margin-top: 15px;">
                    <label>üé• Multi-Camera Mode (Up to 10 Cameras)</label>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button id="start-multi-camera" style="background: linear-gradient(45deg, #9C27B0, #E91E63);">
                            üöÄ Start Multi-Camera
                        </button>
                        <button id="stop-multi-camera" class="stop-btn">
                            üõë Stop All Cameras
                        </button>
                        <button id="configure-multi-camera" style="background: linear-gradient(45deg, #FF9800, #FF5722);">
                            ‚öôÔ∏è Configure Cameras
                        </button>
                    </div>
                    <div id="multi-camera-status" style="margin-top: 10px; font-size: 14px; color: #4CAF50;">
                        No cameras active
                    </div>
                </div>
            </div>

            <div class="status" id="status">
                Ready to start face recognition system...
            </div>
        </div>
        
        <!-- Multi-Camera Configuration Modal -->
        <div id="multi-camera-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; overflow-y: auto;">
            <div style="max-width: 800px; margin: 50px auto; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; border-radius: 15px;">
                <h2 style="color: white; margin-bottom: 20px;">‚öôÔ∏è Configure Multi-Camera Setup</h2>
                <p style="color: rgba(255,255,255,0.9); margin-bottom: 20px;">
                    Select up to 10 cameras to monitor simultaneously. Each camera will run independently.
                </p>
                
                <div id="camera-config-list" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 20px;">
                    <!-- Camera config items will be added here by JavaScript -->
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button id="add-camera-config" style="background: linear-gradient(45deg, #4CAF50, #45a049);">
                        ‚ûï Add Camera
                    </button>
                    <button id="apply-multi-camera" style="background: linear-gradient(45deg, #2196F3, #1976D2);">
                        ‚úÖ Apply & Start
                    </button>
                    <button id="cancel-multi-camera" class="stop-btn">
                        ‚ùå Cancel
                    </button>
                </div>
            </div>
        </div>

```        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab-btn active" onclick="showTab('live-feed')">üìπ Live Feed</button>
            <button class="tab-btn" onclick="showTab('upload-employee')">üë• Employee Management</button>
        </div>

        <div class="main-content">
            <!-- Live Feed Tab -->
            <div id="live-feed" class="tab-content active">
                <div class="video-section">
                    <h3 style="margin-bottom: 15px;">üìπ Live Camera Feed</h3>
                    <div class="video-container">
                        <img id="camera-feed" class="hidden" src="" alt="Camera Feed">
                        <div id="video-placeholder" class="video-placeholder">
                            Select camera and click "Start Camera" to begin
                        </div>
                    </div>
                    
                    <!-- Multi-Camera Grid -->
                    <div id="multi-camera-grid" class="hidden" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin-top: 20px;">
                        <!-- Camera feeds will be added here dynamically -->
                    </div>
                </div>
            </div>

            <!-- Employee Management Tab -->
            <div id="upload-employee" class="tab-content">
                <!-- Sub-Navigation for CRUD Operations -->
                <div class="crud-nav" style="margin-bottom: 20px; text-align: center; border-bottom: 2px solid #2196F3; padding-bottom: 15px;">
                    <button class="crud-btn active" onclick="showCrudSection('add-employee')">‚ûï Add Employee</button>
                    <button class="crud-btn" onclick="showCrudSection('view-employees')">üë• View All</button>
                    <button class="crud-btn" onclick="showCrudSection('search-employee')">üîç Search & Edit</button>
                </div>

                <!-- Add Employee Section -->
                <div id="add-employee" class="crud-section active">
                    <div class="upload-section">
                        <h3 style="margin-bottom: 20px;">‚ûï Add New Employee</h3>
                        
                        <!-- Employee Information Form -->
                        <div class="employee-form">
                            <h4 style="margin-bottom: 15px; color: #4CAF50;">üìù Employee Details</h4>
                            <div class="form-row">
                                <div class="form-group" style="width: 300px; margin: 0 auto;">
                                    <label>Employee ID *</label>
                                    <input type="text" id="emp-id" placeholder="Enter employee ID" required style="font-size: 16px; padding: 12px;">
                                </div>
                            </div>
                        </div>

                        <!-- Photo Upload Methods -->
                        <div class="upload-methods">
                            <div class="upload-method">
                                <h4>üìÅ Upload Multiple Photos</h4>
                                <p style="margin-bottom: 15px; opacity: 0.8;">Select multiple photos from different angles</p>
                                <input type="file" id="multi-photos" class="file-input" multiple accept="image/*">
                                <label for="multi-photos" class="file-label">üìÅ Select Photos</label>
                                <div id="selected-count" style="margin-top: 10px; color: #4CAF50; font-weight: bold;"></div>
                            </div>

                            <div class="upload-method">
                                <h4>üì∑ Capture with Camera</h4>
                                <p style="margin-bottom: 15px; opacity: 0.8;">Capture multiple angles live</p>
                                <button id="start-capture" class="file-label" style="background: linear-gradient(45deg, #FF5722, #E64A19);">üì∑ Start Capture</button>
                                <div id="capture-count" style="margin-top: 10px; color: #FF5722; font-weight: bold;"></div>
                            </div>
                        </div>

                        <!-- Photo Previews -->
                        <div id="photo-previews" class="photo-previews" style="display: none;">
                            <h4 style="width: 100%; margin-bottom: 10px; color: #4CAF50;">Selected Photos:</h4>
                        </div>

                        <!-- Processing Controls -->
                        <div style="text-align: center; margin-top: 20px;">
                            <button id="process-photos" class="file-label" style="background: linear-gradient(45deg, #9C27B0, #7B1FA2); display: none;">üß† Process Photos</button>
                            <button id="save-employee" class="file-label" style="background: linear-gradient(45deg, #4CAF50, #45a049); display: none;">üíæ Save Employee</button>
                            
                            <div class="progress-bar" id="progress-bar" style="display: none;">
                                <div class="progress-fill" id="progress-fill"></div>
                            </div>
                            
                            <div id="upload-status" style="margin-top: 15px; font-weight: bold;"></div>
                        </div>
                    </div>
                </div>

                <!-- View All Employees Section -->
                <div id="view-employees" class="crud-section">
                    <h3 style="margin-bottom: 20px;">üë• All Employees</h3>
                    
                    <div style="margin-bottom: 15px; text-align: center;">
                        <button id="refresh-employees" class="file-label" style="background: linear-gradient(45deg, #2196F3, #1976D2);">üîÑ Refresh List</button>
                        <span id="employee-count" style="margin-left: 15px; font-weight: bold; color: #4CAF50;"></span>
                    </div>

                    <div class="employee-list" id="employee-list">
                        <div class="loading" id="employee-loading">Loading employees...</div>
                    </div>
                </div>

                <!-- Search & Edit Employee Section -->
                <div id="search-employee" class="crud-section">
                    <h3 style="margin-bottom: 20px;">üîç Search & Edit Employee</h3>
                    
                    <div class="search-form">
                        <div class="form-row">
                            <div class="form-group" style="width: 400px; margin: 0 auto;">
                                <label>Search Employee</label>
                                <input type="text" id="search-input" placeholder="Enter Employee ID or Name" style="font-size: 16px; padding: 12px;">
                                <button id="search-btn" class="file-label" style="margin-left: 10px; width: auto; padding: 12px 20px;">üîç Search</button>
                            </div>
                        </div>
                    </div>

                    <div id="search-results" class="search-results" style="margin-top: 20px;">
                        <!-- Search results will appear here -->
                    </div>

                    <!-- Employee Edit Form (Hidden by default) -->
                    <div id="edit-form" class="edit-form" style="display: none; margin-top: 20px; border: 2px solid #4CAF50; padding: 20px; border-radius: 10px; background: rgba(76, 175, 80, 0.1);">
                        <h4 style="margin-bottom: 15px; color: #4CAF50;">‚úèÔ∏è Edit Employee</h4>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>Employee ID</label>
                                <input type="text" id="edit-emp-id" readonly style="background: #f5f5f5;">
                            </div>
                            <div class="form-group">
                                <label>Employee Name</label>
                                <input type="text" id="edit-emp-name" placeholder="Employee Name">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Status</label>
                                <select id="edit-emp-status">
                                    <option value="1">‚úÖ Active</option>
                                    <option value="0">‚ùå Disabled</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Total Photos</label>
                                <input type="text" id="edit-photo-count" readonly style="background: #f5f5f5;">
                            </div>
                        </div>

                        <!-- Re-upload Photos Section -->
                        <div style="margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px;">
                            <h5 style="margin-bottom: 10px;">üìÅ Re-upload Photos (Optional)</h5>
                            <input type="file" id="edit-photos" class="file-input" multiple accept="image/*">
                            <label for="edit-photos" class="file-label" style="background: linear-gradient(45deg, #FF9800, #F57C00);">üìÅ Select New Photos</label>
                            <div id="edit-selected-count" style="margin-top: 10px; color: #FF9800; font-weight: bold;"></div>
                        </div>

                        <!-- Action Buttons -->
                        <div style="text-align: center; margin-top: 20px;">
                            <button id="update-employee" class="file-label" style="background: linear-gradient(45deg, #4CAF50, #45a049);">üíæ Update Employee</button>
                            <button id="delete-employee" class="file-label" style="background: linear-gradient(45deg, #f44336, #d32f2f); margin-left: 10px;">üóëÔ∏è Delete Employee</button>
                            <button id="cancel-edit" class="file-label" style="background: linear-gradient(45deg, #9E9E9E, #757575); margin-left: 10px;">‚ùå Cancel</button>
                        </div>
                        
                        <div id="edit-status" style="margin-top: 15px; font-weight: bold; text-align: center;"></div>
                    </div>
                </div>
            </div>

            <div class="info-section">
                <div class="info-panel">
                    <h3>üìä System Stats</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-number" id="faces-loaded">0</div>
                            <div class="stat-label">Faces Loaded</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="detections-count">0</div>
                            <div class="stat-label">Detections</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="camera-status">OFF</div>
                            <div class="stat-label">Camera Status</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="current-camera">None</div>
                            <div class="stat-label">Active Camera</div>
                        </div>
                    </div>
                </div>

                <div class="info-panel">
                    <h3>üéØ Recent Detections</h3>
                    <div class="detection-list" id="detection-list">
                        <div style="text-align: center; opacity: 0.6; padding: 20px;">
                            No detections yet...
                        </div>
                    </div>
                </div>

                <div class="info-panel">
                    <h3>üì∏ Face Crops</h3>
                    <div class="control-group">
                        <button id="view-crops-btn" style="width: 100%; margin-bottom: 10px;">View Face Crops</button>
                    </div>
                    <div class="detection-list" id="face-crops-list" style="max-height: 200px;">
                        <div style="text-align: center; opacity: 0.6; padding: 20px;">
                            Click "View Face Crops" to load...
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let cameraActive = false;
        let facesLoaded = false;
        let detectionInterval;
        
        // Tab Management
        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
        }

        // Multi-angle upload variables
        let selectedPhotos = [];
        let processedEncodings = [];
        let capturedPhotos = [];

        // DOM Elements
        const cameraType = document.getElementById('camera-type');
        const cctvChannel = document.getElementById('cctv-channel');
        const channelGroup = document.getElementById('channel-group');
        const detectionMode = document.getElementById('detection-mode');
        const confidenceThreshold = document.getElementById('confidence-threshold');
        const confidenceValue = document.getElementById('confidence-value');
        const strictnessMode = document.getElementById('strictness-mode');
        const loadFacesBtn = document.getElementById('load-faces');
        const startCameraBtn = document.getElementById('start-camera');
        const stopCameraBtn = document.getElementById('stop-camera');
        const status = document.getElementById('status');
        const cameraFeed = document.getElementById('camera-feed');
        const videoPlaceholder = document.getElementById('video-placeholder');
        const facesLoadedStat = document.getElementById('faces-loaded');
        const detectionsCountStat = document.getElementById('detections-count');
        const cameraStatusStat = document.getElementById('camera-status');
        const currentCameraStat = document.getElementById('current-camera');
        const detectionList = document.getElementById('detection-list');
        const viewCropsBtn = document.getElementById('view-crops-btn');
        const faceCropsList = document.getElementById('face-crops-list');
        const fpsDisplay = document.getElementById('fps-display');
        const cpuDisplay = document.getElementById('cpu-display');

        // Show/hide channel selection and auto-restart camera
        cameraType.addEventListener('change', async () => {
            const selectedType = cameraType.value;
            
            // Show channel input for CCTV systems
            if (selectedType === 'cctv1' || selectedType === 'cctv2' || selectedType === 'cctv') {
                channelGroup.style.display = 'flex';
            } else {
                channelGroup.style.display = 'none';
            }
            
            // Auto-restart camera if currently active
            if (cameraActive && facesLoaded) {
                updateStatus('üîÑ Switching camera...', 'info');
                await stopCurrentCamera();
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // Auto-start with new camera type
                startCameraBtn.click();
            }
        });

        // Auto-restart when CCTV channel changes
        cctvChannel.addEventListener('change', async () => {
            if (cameraActive && cameraType.value === 'cctv' && facesLoaded) {
                updateStatus(`üîÑ Switching to Channel ${cctvChannel.value}...`, 'info');
                await stopCurrentCamera();
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // Auto-start with new channel
                startCameraBtn.click();
            }
        });

        // Detection mode change handler
        detectionMode.addEventListener('change', async () => {
            const mode = detectionMode.value;
            updateStatus(`üîß Switching to ${mode.charAt(0).toUpperCase() + mode.slice(1)} mode...`, 'info');
            
            try {
                const response = await fetch('/api/set_detection_mode', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ mode: mode })
                });
                
                const data = await response.json();
                if (data.success) {
                    updateStatus(`‚úÖ Detection mode set to ${mode.charAt(0).toUpperCase() + mode.slice(1)}`, 'success');
                    
                    // Auto-restart camera if currently active
                    if (cameraActive && facesLoaded) {
                        await stopCurrentCamera();
                        await new Promise(resolve => setTimeout(resolve, 500));
                        startCameraBtn.click();
                    }
                } else {
                    updateStatus(`‚ùå Failed to change detection mode: ${data.message}`, 'error');
                }
            } catch (error) {
                console.error('Error changing detection mode:', error);
                updateStatus('‚ùå Error changing detection mode', 'error');
            }
        });

        // Confidence threshold change handler
        confidenceThreshold.addEventListener('input', () => {
            const value = confidenceThreshold.value;
            confidenceValue.textContent = `${value}%`;
            updateConfidenceSettings();
        });

        // Strictness mode change handler
        strictnessMode.addEventListener('change', () => {
            updateConfidenceSettings();
        });

        // Update confidence settings function
        async function updateConfidenceSettings() {
            const confidence = parseFloat(confidenceThreshold.value);
            const strictness = strictnessMode.value;
            
            try {
                const response = await fetch('/api/set_confidence_settings', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        confidence_threshold: confidence,
                        strictness_mode: strictness
                    })
                });
                
                const data = await response.json();
                if (data.success) {
                    updateStatus(`‚úÖ Confidence: ${confidence}% (${strictness})`, 'success');
                } else {
                    updateStatus(`‚ùå Failed to update confidence: ${data.message}`, 'error');
                }
            } catch (error) {
                console.error('Error updating confidence:', error);
                updateStatus('‚ùå Error updating confidence settings', 'error');
            }
        }

        // Initially hide channel group
        channelGroup.style.display = 'none';

        // Update status
        function updateStatus(message, type = 'info') {
            status.innerHTML = `<span class="${type}">${message}</span>`;
        }

        // Load faces
        loadFacesBtn.addEventListener('click', async () => {
            loadFacesBtn.innerHTML = '<span class="loading"></span> Loading...';
            loadFacesBtn.disabled = true;

            try {
                const response = await fetch('/api/load_faces', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    facesLoaded = true;
                    facesLoadedStat.textContent = data.count;
                    updateStatus(`‚úÖ ${data.message}`, 'success');
                } else {
                    updateStatus(`‚ùå ${data.message}`, 'error');
                }
            } catch (error) {
                updateStatus(`‚ùå Error loading faces: ${error.message}`, 'error');
            }

            loadFacesBtn.innerHTML = 'Load Faces';
            loadFacesBtn.disabled = false;
        });

        // Start camera
        startCameraBtn.addEventListener('click', async () => {
            if (!facesLoaded) {
                updateStatus('‚ö†Ô∏è Please load faces first!', 'warning');
                return;
            }

            // Stop current camera first if active
            if (cameraActive) {
                await stopCurrentCamera();
                await new Promise(resolve => setTimeout(resolve, 1000)); // Wait 1 second
            }

            startCameraBtn.innerHTML = '<span class="loading"></span> Starting...';
            startCameraBtn.disabled = true;

            const selectedCameraType = cameraType.value;
            const channelValue = cctvChannel.value; // Get channel from input field (1-128)
            
            const cameraData = {
                camera_type: selectedCameraType,
                channel: (selectedCameraType === 'cctv' || selectedCameraType === 'cctv1' || selectedCameraType === 'cctv2') ? channelValue : null
            };

            try {
                const response = await fetch('/api/start_camera', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(cameraData)
                });
                
                const data = await response.json();
                
                if (data.success) {
                    cameraActive = true;
                    // Clear previous feed and add timestamp to prevent caching
                    cameraFeed.src = '';
                    await new Promise(resolve => setTimeout(resolve, 500)); // Wait for cleanup
                    cameraFeed.src = '/api/camera_frame?' + new Date().getTime();
                    cameraFeed.classList.remove('hidden');
                    videoPlaceholder.classList.add('hidden');
                    
                    cameraStatusStat.textContent = 'ON';
                    currentCameraStat.textContent = cameraType.value === 'cctv' ? 
                        `CCTV ${cctvChannel.value}` : 'Webcam';
                    
                    updateStatus(`‚úÖ ${data.message}`, 'success');
                    
                    // Start detection updates and performance monitoring
                    startDetectionUpdates();
                    startPerformanceMonitoring();
                } else {
                    updateStatus(`‚ùå ${data.message}`, 'error');
                }
            } catch (error) {
                updateStatus(`‚ùå Error starting camera: ${error.message}`, 'error');
            }

            startCameraBtn.innerHTML = 'Start Camera';
            startCameraBtn.disabled = false;
        });

        // Stop camera function
        async function stopCurrentCamera() {
            try {
                const response = await fetch('/api/stop_camera', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                const data = await response.json();
                
                cameraActive = false;
                cameraFeed.src = ''; // Clear feed source
                cameraFeed.classList.add('hidden');
                videoPlaceholder.classList.remove('hidden');
                
                cameraStatusStat.textContent = 'OFF';
                currentCameraStat.textContent = 'None';
                
                // Stop detection updates and performance monitoring
                if (detectionInterval) {
                    clearInterval(detectionInterval);
                    detectionInterval = null;
                }
                stopPerformanceMonitoring();
                
                return data;
            } catch (error) {
                console.error('Error stopping camera:', error);
                return { success: false, message: error.message };
            }
        }

        // Stop camera button event
        stopCameraBtn.addEventListener('click', async () => {
            const result = await stopCurrentCamera();
            updateStatus(`üõë ${result.message || 'Camera stopped'}`, 'warning');
        });

        // Start detection updates
        function startDetectionUpdates() {
            detectionInterval = setInterval(async () => {
                if (!cameraActive) return;
                
                try {
                    const response = await fetch('/api/detections');
                    const data = await response.json();
                    
                    updateDetectionList(data.detections);
                    detectionsCountStat.textContent = data.detections.length;
                } catch (error) {
                    console.error('Error fetching detections:', error);
                }
            }, 2000); // Update every 2 seconds
        }

        // Update detection list
        function updateDetectionList(detections) {
            if (detections.length === 0) {
                detectionList.innerHTML = `
                    <div style="text-align: center; opacity: 0.6; padding: 20px;">
                        No detections yet...
                    </div>
                `;
                return;
            }

            detectionList.innerHTML = detections.map(detection => `
                <div class="detection-item">
                    <div class="detection-name">${detection.name}</div>
                    <div class="detection-details">
                        üìπ ${detection.camera} ‚Ä¢ ‚è∞ ${detection.time}
                    </div>
                </div>
            `).join('');
        }

        // View Face Crops
        viewCropsBtn.addEventListener('click', async () => {
            try {
                updateStatus('üì∏ Loading face crops...', 'info');
                viewCropsBtn.innerHTML = '<span class="loading"></span> Loading...';
                
                const response = await fetch('/api/face_crops');
                const data = await response.json();
                
                let cropsHtml = '';
                
                // Show detected faces
                if (data.detected_faces && data.detected_faces.length > 0) {
                    cropsHtml += '<div style="font-size: 0.9em; color: #4CAF50; margin-bottom: 10px; font-weight: bold;">‚úÖ Detected Faces:</div>';
                    data.detected_faces.slice(0, 10).forEach(filename => {
                        const displayName = filename.split('_')[0].replace(/[0-9]/g, '');
                        cropsHtml += `
                            <div class="detection-item" style="padding: 5px; margin-bottom: 5px;">
                                <div style="font-size: 0.8em;">${displayName}</div>
                                <div style="font-size: 0.7em; opacity: 0.7;">${filename}</div>
                            </div>
                        `;
                    });
                }
                
                // Show unknown faces
                if (data.unknown_faces && data.unknown_faces.length > 0) {
                    cropsHtml += '<div style="font-size: 0.9em; color: #FF9800; margin: 10px 0; font-weight: bold;">‚ùì Unknown Faces:</div>';
                    data.unknown_faces.slice(0, 10).forEach(filename => {
                        cropsHtml += `
                            <div class="detection-item" style="padding: 5px; margin-bottom: 5px;">
                                <div style="font-size: 0.8em;">Unknown Person</div>
                                <div style="font-size: 0.7em; opacity: 0.7;">${filename}</div>
                            </div>
                        `;
                    });
                }
                
                if (cropsHtml === '') {
                    cropsHtml = '<div style="text-align: center; opacity: 0.6; padding: 20px;">No face crops saved yet...</div>';
                }
                
                faceCropsList.innerHTML = cropsHtml;
                viewCropsBtn.innerHTML = 'üì∏ View Face Crops';
                updateStatus('‚úÖ Face crops loaded successfully!', 'success');
                
            } catch (error) {
                console.error('Error loading face crops:', error);
                faceCropsList.innerHTML = '<div style="color: #f44336; padding: 10px;">Error loading face crops</div>';
                viewCropsBtn.innerHTML = 'üì∏ View Face Crops';
                updateStatus('‚ùå Failed to load face crops', 'error');
            }
        });

        // Update performance stats
        function updatePerformanceStats() {
            if (!cameraActive) return;
            
            fetch('/api/performance_stats')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        if (fpsDisplay) {
                            fpsDisplay.textContent = `${data.stats.fps.toFixed(1)} FPS`;
                        }
                        if (cpuDisplay) {
                            cpuDisplay.textContent = `${data.stats.cpu_usage.toFixed(1)}%`;
                        }
                    }
                })
                .catch(error => {
                    console.error('Error fetching performance stats:', error);
                });
        }

        // Start performance monitoring when camera starts
        let performanceInterval;

        function startPerformanceMonitoring() {
            if (performanceInterval) {
                clearInterval(performanceInterval);
            }
            performanceInterval = setInterval(updatePerformanceStats, 2000); // Update every 2 seconds
        }

        function stopPerformanceMonitoring() {
            if (performanceInterval) {
                clearInterval(performanceInterval);
                performanceInterval = null;
            }
            // Reset displays
            if (fpsDisplay) fpsDisplay.textContent = '0.0 FPS';
            if (cpuDisplay) cpuDisplay.textContent = '0.0%';
        }

        // Upload functionality for multi-angle faces
        let currentPhotos = [];
        
        function showTab(tabName, clickedTab) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            clickedTab.classList.add('active');
        }
        
        function handleFileSelect(event) {
            const files = Array.from(event.target.files);
            const photoGrid = document.getElementById('photoGrid');
            
            files.forEach(file => {
                if (file.type.startsWith('image/') && currentPhotos.length < 5) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const photoDiv = document.createElement('div');
                        photoDiv.className = 'photo-item';
                        photoDiv.innerHTML = `
                            <img src="${e.target.result}" alt="Employee Photo">
                            <button type="button" onclick="removePhoto(this)" class="remove-btn">√ó</button>
                        `;
                        photoGrid.appendChild(photoDiv);
                        
                        currentPhotos.push({
                            file: file,
                            dataUrl: e.target.result
                        });
                        
                        updatePhotoCount();
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Clear the file input
            event.target.value = '';
        }
        
        function removePhoto(button) {
            const photoItem = button.parentElement;
            const index = Array.from(photoItem.parentElement.children).indexOf(photoItem);
            
            currentPhotos.splice(index, 1);
            photoItem.remove();
            updatePhotoCount();
        }
        
        function updatePhotoCount() {
            const countElement = document.getElementById('photoCount');
            countElement.textContent = `${currentPhotos.length}/5 photos selected`;
            
            const submitBtn = document.getElementById('submitEmployee');
            submitBtn.disabled = currentPhotos.length === 0;
        }
        
        function openCamera() {
            navigator.mediaDevices.getUserMedia({ video: true })
                .then(function(stream) {
                    const video = document.createElement('video');
                    video.srcObject = stream;
                    video.autoplay = true;
                    video.style.width = '100%';
                    video.style.maxWidth = '400px';
                    
                    const modal = document.createElement('div');
                    modal.style.cssText = `
                        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                        background: rgba(0,0,0,0.8); display: flex; align-items: center;
                        justify-content: center; z-index: 1000;
                    `;
                    
                    const container = document.createElement('div');
                    container.style.cssText = `
                        background: white; padding: 20px; border-radius: 10px;
                        text-align: center; max-width: 500px; width: 90%;
                    `;
                    
                    const captureBtn = document.createElement('button');
                    captureBtn.textContent = 'Capture Photo';
                    captureBtn.style.cssText = `
                        background: #007bff; color: white; border: none;
                        padding: 10px 20px; margin: 10px; border-radius: 5px;
                        cursor: pointer;
                    `;
                    
                    const closeBtn = document.createElement('button');
                    closeBtn.textContent = 'Close';
                    closeBtn.style.cssText = `
                        background: #dc3545; color: white; border: none;
                        padding: 10px 20px; margin: 10px; border-radius: 5px;
                        cursor: pointer;
                    `;
                    
                    captureBtn.onclick = function() {
                        if (currentPhotos.length < 5) {
                            const canvas = document.createElement('canvas');
                            const context = canvas.getContext('2d');
                            canvas.width = video.videoWidth;
                            canvas.height = video.videoHeight;
                            context.drawImage(video, 0, 0);
                            
                            const dataUrl = canvas.toDataURL('image/jpeg');
                            
                            // Convert dataURL to file
                            const byteString = atob(dataUrl.split(',')[1]);
                            const mimeString = dataUrl.split(',')[0].split(':')[1].split(';')[0];
                            const ab = new ArrayBuffer(byteString.length);
                            const ia = new Uint8Array(ab);
                            for (let i = 0; i < byteString.length; i++) {
                                ia[i] = byteString.charCodeAt(i);
                            }
                            const file = new Blob([ab], { type: mimeString });
                            file.name = `camera_${Date.now()}.jpg`;
                            
                            const photoDiv = document.createElement('div');
                            photoDiv.className = 'photo-item';
                            photoDiv.innerHTML = `
                                <img src="${dataUrl}" alt="Employee Photo">
                                <button type="button" onclick="removePhoto(this)" class="remove-btn">√ó</button>
                            `;
                            document.getElementById('photoGrid').appendChild(photoDiv);
                            
                            currentPhotos.push({
                                file: file,
                                dataUrl: dataUrl
                            });
                            
                            updatePhotoCount();
                        }
                    };
                    
                    closeBtn.onclick = function() {
                        stream.getTracks().forEach(track => track.stop());
                        document.body.removeChild(modal);
                    };
                    
                    container.appendChild(video);
                    container.appendChild(document.createElement('br'));
                    container.appendChild(captureBtn);
                    container.appendChild(closeBtn);
                    modal.appendChild(container);
                    document.body.appendChild(modal);
                })
                .catch(function(error) {
                    alert('Camera access denied or not available: ' + error.message);
                });
        }
        
        function submitEmployee() {
            const employeeName = document.getElementById('employeeName').value.trim();
            const employeeId = document.getElementById('employeeId').value.trim();
            
            if (!employeeName || !employeeId) {
                alert('Please fill in all employee details');
                return;
            }
            
            if (currentPhotos.length === 0) {
                alert('Please select at least one photo');
                return;
            }
            
            const formData = new FormData();
            formData.append('employee_name', employeeName);
            formData.append('employee_id', employeeId);
            
            currentPhotos.forEach((photo, index) => {
                formData.append('photos', photo.file);
            });
            
            // Show progress
            const progressContainer = document.getElementById('uploadProgress');
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            
            progressContainer.style.display = 'block';
            progressBar.style.width = '0%';
            progressText.textContent = 'Uploading photos...';
            
            fetch('/upload_employee', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                progressBar.style.width = '100%';
                if (data.success) {
                    progressText.textContent = '‚úÖ Employee added successfully!';
                    // Clear form
                    document.getElementById('employeeForm').reset();
                    document.getElementById('photoGrid').innerHTML = '';
                    currentPhotos = [];
                    updatePhotoCount();
                    
                    // Hide progress after 2 seconds
                    setTimeout(() => {
                        progressContainer.style.display = 'none';
                    }, 2000);
                } else {
                    progressText.textContent = '‚ùå Error: ' + data.message;
                }
            })
            .catch(error => {
                progressText.textContent = '‚ùå Upload failed: ' + error.message;
            });
        }
        
        // Upload tab photo handling
        let selectedFiles = [];
        
        document.getElementById('multi-photos').addEventListener('change', function(event) {
            selectedFiles = Array.from(event.target.files);
            const countDiv = document.getElementById('selected-count');
            const previewDiv = document.getElementById('photo-previews');
            const processBtn = document.getElementById('process-photos');
            
            if (selectedFiles.length > 0) {
                countDiv.textContent = `üìÅ ${selectedFiles.length} photos selected`;
                countDiv.style.display = 'block';
                
                // Show previews
                previewDiv.innerHTML = '<h4 style="width: 100%; margin-bottom: 10px; color: #4CAF50;">Selected Photos:</h4>';
                selectedFiles.forEach((file, index) => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const img = document.createElement('img');
                        img.src = e.target.result;
                        img.style.cssText = 'width: 100px; height: 100px; object-fit: cover; margin: 5px; border-radius: 8px; border: 2px solid #4CAF50;';
                        previewDiv.appendChild(img);
                    };
                    reader.readAsDataURL(file);
                });
                
                previewDiv.style.display = 'block';
                processBtn.style.display = 'inline-block';
            } else {
                countDiv.style.display = 'none';
                previewDiv.style.display = 'none';
                processBtn.style.display = 'none';
            }
        });
        
        document.getElementById('process-photos').addEventListener('click', async function() {
            const employeeId = document.getElementById('emp-id').value.trim();
            
            if (!employeeId) {
                alert('‚ùå Please enter Employee ID first!');
                return;
            }
            
            if (selectedFiles.length === 0) {
                alert('‚ùå Please select photos first!');
                return;
            }
            
            const progressBar = document.getElementById('progress-bar');
            const progressFill = document.getElementById('progress-fill');
            const statusDiv = document.getElementById('upload-status');
            const saveBtn = document.getElementById('save-employee');
            
            progressBar.style.display = 'block';
            statusDiv.textContent = 'üì§ Uploading photos...';
            
            try {
                const formData = new FormData();
                formData.append('employee_id', employeeId);
                
                selectedFiles.forEach((file, index) => {
                    formData.append('photos', file);
                });
                
                const response = await fetch('/upload_employee_photos', {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                if (result.success) {
                    progressFill.style.width = '100%';
                    statusDiv.innerHTML = `‚úÖ Success! Uploaded ${result.uploaded_count} photos for Employee ID: ${employeeId}`;
                    statusDiv.style.color = '#4CAF50';
                    
                    // Reset form after success
                    setTimeout(() => {
                        document.getElementById('emp-id').value = '';
                        document.getElementById('multi-photos').value = '';
                        selectedFiles = [];
                        document.getElementById('selected-count').style.display = 'none';
                        document.getElementById('photo-previews').style.display = 'none';
                        document.getElementById('process-photos').style.display = 'none';
                        progressBar.style.display = 'none';
                        statusDiv.textContent = '';
                    }, 3000);
                } else {
                    statusDiv.innerHTML = `‚ùå Error: ${result.message}`;
                    statusDiv.style.color = '#f44336';
                }
            } catch (error) {
                statusDiv.innerHTML = `‚ùå Upload failed: ${error.message}`;
                statusDiv.style.color = '#f44336';
            }
        });

        // ============ CRUD Operations JavaScript ============
        
        // Show CRUD section
        function showCrudSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.crud-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active from all buttons
            document.querySelectorAll('.crud-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Add active to clicked button
            event.target.classList.add('active');
            
            // Load data based on section
            if (sectionId === 'view-employees') {
                loadAllEmployees();
            }
        }

        // Load all employees
        async function loadAllEmployees() {
            const employeeList = document.getElementById('employee-list');
            const employeeCount = document.getElementById('employee-count');
            const loading = document.getElementById('employee-loading');
            
            loading.style.display = 'block';
            employeeList.innerHTML = '<div class="loading" id="employee-loading">Loading employees...</div>';
            
            try {
                const response = await fetch('/api/employees');
                const data = await response.json();
                
                loading.style.display = 'none';
                
                if (data.success) {
                    employeeCount.textContent = `Total: ${data.employees.length} employees`;
                    
                    if (data.employees.length === 0) {
                        employeeList.innerHTML = '<div class="loading">No employees found</div>';
                        return;
                    }
                    
                    let html = '';
                    data.employees.forEach(emp => {
                        const statusClass = emp.is_active ? 'status-active' : 'status-disabled';
                        const statusText = emp.is_active ? '‚úÖ Active' : '‚ùå Disabled';
                        const toggleAction = emp.is_active ? 'disable' : 'enable';
                        const toggleText = emp.is_active ? '‚ùå' : '‚úÖ';
                        
                        html += `
                            <div class="employee-item">
                                <div class="employee-info">
                                    <strong>ID: ${emp.id}</strong><br>
                                    <span>Name: ${emp.employee_name || 'N/A'}</span><br>
                                    <span>Photos: ${emp.total_photos || 0}</span><br>
                                    <span class="${statusClass}">Status: ${statusText}</span>
                                </div>
                                <div class="employee-actions">
                                    <button class="action-btn edit" onclick="editEmployee('${emp.id}')">‚úèÔ∏è Edit</button>
                                    <button class="action-btn toggle ${emp.is_active ? '' : 'active'}" onclick="toggleEmployee('${emp.id}', '${toggleAction}')">${toggleText}</button>
                                    <button class="action-btn delete" onclick="confirmDeleteEmployee('${emp.id}')">üóëÔ∏è Delete</button>
                                </div>
                            </div>
                        `;
                    });
                    
                    employeeList.innerHTML = html;
                } else {
                    employeeList.innerHTML = '<div class="loading">Error loading employees</div>';
                    employeeCount.textContent = 'Error loading data';
                }
            } catch (error) {
                console.error('Error loading employees:', error);
                employeeList.innerHTML = '<div class="loading">Error connecting to server</div>';
                loading.style.display = 'none';
            }
        }

        // Search employee
        async function searchEmployee() {
            const searchInput = document.getElementById('search-input');
            const searchResults = document.getElementById('search-results');
            const query = searchInput.value.trim();
            
            if (!query) {
                searchResults.innerHTML = '<div class="loading">Enter Employee ID or Name to search</div>';
                return;
            }
            
            searchResults.innerHTML = '<div class="loading">Searching...</div>';
            
            try {
                const response = await fetch(`/api/employees/search?q=${encodeURIComponent(query)}`);
                const data = await response.json();
                
                if (data.success && data.employees.length > 0) {
                    let html = '';
                    data.employees.forEach(emp => {
                        const statusClass = emp.is_active ? 'status-active' : 'status-disabled';
                        const statusText = emp.is_active ? '‚úÖ Active' : '‚ùå Disabled';
                        
                        html += `
                            <div class="employee-item">
                                <div class="employee-info">
                                    <strong>ID: ${emp.id}</strong><br>
                                    <span>Name: ${emp.employee_name || 'N/A'}</span><br>
                                    <span>Photos: ${emp.total_photos || 0}</span><br>
                                    <span class="${statusClass}">Status: ${statusText}</span>
                                </div>
                                <div class="employee-actions">
                                    <button class="action-btn edit" onclick="editEmployee('${emp.id}')">‚úèÔ∏è Edit</button>
                                </div>
                            </div>
                        `;
                    });
                    searchResults.innerHTML = html;
                } else {
                    searchResults.innerHTML = '<div class="loading">No employees found</div>';
                }
            } catch (error) {
                console.error('Error searching employees:', error);
                searchResults.innerHTML = '<div class="loading">Error searching</div>';
            }
        }

        // Edit employee
        async function editEmployee(employeeId) {
            const editForm = document.getElementById('edit-form');
            const editStatus = document.getElementById('edit-status');
            
            editStatus.innerHTML = 'Loading employee data...';
            editForm.style.display = 'block';
            
            try {
                const response = await fetch(`/api/employees/${employeeId}`);
                const data = await response.json();
                
                if (data.success) {
                    const emp = data.employee;
                    document.getElementById('edit-emp-id').value = emp.id;
                    document.getElementById('edit-emp-name').value = emp.employee_name || '';
                    document.getElementById('edit-emp-status').value = emp.is_active ? '1' : '0';
                    document.getElementById('edit-photo-count').value = emp.total_photos || 0;
                    editStatus.innerHTML = '';
                } else {
                    editStatus.innerHTML = '‚ùå Error loading employee data';
                    editStatus.style.color = '#f44336';
                }
            } catch (error) {
                console.error('Error loading employee:', error);
                editStatus.innerHTML = '‚ùå Error connecting to server';
                editStatus.style.color = '#f44336';
            }
        }

        // Update employee
        async function updateEmployee() {
            const employeeId = document.getElementById('edit-emp-id').value;
            const employeeName = document.getElementById('edit-emp-name').value;
            const isActive = document.getElementById('edit-emp-status').value;
            const editPhotos = document.getElementById('edit-photos').files;
            const editStatus = document.getElementById('edit-status');
            
            const formData = new FormData();
            formData.append('employee_id', employeeId);
            formData.append('employee_name', employeeName);
            formData.append('is_active', isActive);
            
            // Add new photos if selected
            for (let i = 0; i < editPhotos.length; i++) {
                formData.append('photos', editPhotos[i]);
            }
            
            editStatus.innerHTML = 'Updating employee...';
            editStatus.style.color = '#2196F3';
            
            try {
                const response = await fetch('/api/employees/update', {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (data.success) {
                    editStatus.innerHTML = '‚úÖ Employee updated successfully';
                    editStatus.style.color = '#4CAF50';
                    
                    // Refresh the employee list if it's visible
                    const viewSection = document.getElementById('view-employees');
                    if (viewSection.classList.contains('active')) {
                        setTimeout(() => loadAllEmployees(), 1000);
                    }
                    
                    // Clear form after 2 seconds
                    setTimeout(() => {
                        document.getElementById('edit-form').style.display = 'none';
                        document.getElementById('edit-photos').value = '';
                        document.getElementById('edit-selected-count').innerHTML = '';
                    }, 2000);
                } else {
                    editStatus.innerHTML = `‚ùå Update failed: ${data.message}`;
                    editStatus.style.color = '#f44336';
                }
            } catch (error) {
                console.error('Error updating employee:', error);
                editStatus.innerHTML = '‚ùå Error updating employee';
                editStatus.style.color = '#f44336';
            }
        }

        // Toggle employee status
        async function toggleEmployee(employeeId, action) {
            try {
                const response = await fetch('/api/employees/toggle', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        employee_id: employeeId,
                        action: action
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    // Refresh the employee list
                    loadAllEmployees();
                } else {
                    alert(`Error: ${data.message}`);
                }
            } catch (error) {
                console.error('Error toggling employee status:', error);
                alert('Error updating employee status');
            }
        }

        // Confirm delete employee
        function confirmDeleteEmployee(employeeId) {
            if (confirm(`Are you sure you want to DELETE employee ${employeeId}?\n\nThis will permanently remove:\n- Employee record\n- All face embeddings\n- Cannot be undone!`)) {
                deleteEmployee(employeeId);
            }
        }

        // Delete employee
        async function deleteEmployee(employeeId) {
            try {
                const response = await fetch('/api/employees/delete', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        employee_id: employeeId
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    alert('‚úÖ Employee deleted successfully');
                    loadAllEmployees(); // Refresh the list
                } else {
                    alert(`‚ùå Delete failed: ${data.message}`);
                }
            } catch (error) {
                console.error('Error deleting employee:', error);
                alert('‚ùå Error deleting employee');
            }
        }

        // Event Listeners for CRUD operations
        document.addEventListener('DOMContentLoaded', function() {
            // Refresh employees button
            const refreshBtn = document.getElementById('refresh-employees');
            if (refreshBtn) {
                refreshBtn.addEventListener('click', loadAllEmployees);
            }
            
            // Search button
            const searchBtn = document.getElementById('search-btn');
            if (searchBtn) {
                searchBtn.addEventListener('click', searchEmployee);
            }
            
            // Search input enter key
            const searchInput = document.getElementById('search-input');
            if (searchInput) {
                searchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        searchEmployee();
                    }
                });
            }
            
            // Update employee button
            const updateBtn = document.getElementById('update-employee');
            if (updateBtn) {
                updateBtn.addEventListener('click', updateEmployee);
            }
            
            // Cancel edit button
            const cancelBtn = document.getElementById('cancel-edit');
            if (cancelBtn) {
                cancelBtn.addEventListener('click', function() {
                    document.getElementById('edit-form').style.display = 'none';
                    document.getElementById('edit-photos').value = '';
                    document.getElementById('edit-selected-count').innerHTML = '';
                });
            }
            
            // Edit photos file input
            const editPhotos = document.getElementById('edit-photos');
            if (editPhotos) {
                editPhotos.addEventListener('change', function() {
                    const count = this.files.length;
                    document.getElementById('edit-selected-count').innerHTML = 
                        count > 0 ? `${count} photo(s) selected for re-upload` : '';
                });
            }
        });

        // Auto-load faces on page load
        window.addEventListener('load', () => {
            updateStatus('üöÄ System ready! Click "Load Faces" to begin.');
        });
        
        // ============ Multi-Camera Mode JavaScript ============
        let multiCameraConfigs = [];
        let multiCameraActive = false;
        
        // Configure multi-camera button
        document.getElementById('configure-multi-camera').addEventListener('click', () => {
            document.getElementById('multi-camera-modal').style.display = 'block';
            renderCameraConfigs();
        });
        
        // Cancel multi-camera config
        document.getElementById('cancel-multi-camera').addEventListener('click', () => {
            document.getElementById('multi-camera-modal').style.display = 'none';
        });
        
        // Add camera to config
        document.getElementById('add-camera-config').addEventListener('click', () => {
            if (multiCameraConfigs.length >= 10) {
                alert('Maximum 10 cameras allowed!');
                return;
            }
            multiCameraConfigs.push({ type: 'cctv1', channel: 1 });
            renderCameraConfigs();
        });
        
        // Render camera configuration items
        function renderCameraConfigs() {
            const container = document.getElementById('camera-config-list');
            if (multiCameraConfigs.length === 0) {
                container.innerHTML = '<p style="color: white; grid-column: 1 / -1;">No cameras configured. Click "Add Camera" to start.</p>';
                return;
            }
            
            container.innerHTML = multiCameraConfigs.map((config, idx) => `
                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px;">
                    <h4 style="color: white; margin-bottom: 10px;">üìπ Camera ${idx + 1}</h4>
                    <select onchange="updateCameraConfig(${idx}, 'type', this.value)" style="width: 100%; margin-bottom: 10px; padding: 8px; border-radius: 5px;">
                        <option value="cctv1" ${config.type === 'cctv1' ? 'selected' : ''}>CCTV System 1</option>
                        <option value="cctv2" ${config.type === 'cctv2' ? 'selected' : ''}>CCTV System 2</option>
                        <option value="webcam" ${config.type === 'webcam' ? 'selected' : ''}>Webcam</option>
                    </select>
                    <input type="number" value="${config.channel}" onchange="updateCameraConfig(${idx}, 'channel', this.value)" 
                           min="1" max="128" placeholder="Channel" 
                           style="width: 100%; margin-bottom: 10px; padding: 8px; border-radius: 5px;"
                           ${config.type === 'webcam' ? 'disabled' : ''}>
                    <button onclick="removeCameraConfig(${idx})" style="background: #f44336; color: white; padding: 8px; border: none; border-radius: 5px; cursor: pointer; width: 100%;">
                        üóëÔ∏è Remove
                    </button>
                </div>
            `).join('');
        }
        
        // Update camera config
        window.updateCameraConfig = (idx, field, value) => {
            multiCameraConfigs[idx][field] = field === 'channel' ? parseInt(value) : value;
            renderCameraConfigs();
        };
        
        // Remove camera config
        window.removeCameraConfig = (idx) => {
            multiCameraConfigs.splice(idx, 1);
            renderCameraConfigs();
        };
        
        // Apply and start multi-camera
        document.getElementById('apply-multi-camera').addEventListener('click', async () => {
            if (multiCameraConfigs.length === 0) {
                alert('Please add at least one camera!');
                return;
            }
            
            document.getElementById('multi-camera-modal').style.display = 'none';
            await startMultiCameras(multiCameraConfigs);
        });
        
        // Start multi-camera mode
        document.getElementById('start-multi-camera').addEventListener('click', async () => {
            if (multiCameraConfigs.length === 0) {
                // Quick start with default 10 cameras
                multiCameraConfigs = [
                    { type: 'cctv1', channel: 1 },
                    { type: 'cctv1', channel: 2 },
                    { type: 'cctv2', channel: 1 },
                    { type: 'cctv2', channel: 2 },
                    { type: 'cctv1', channel: 3 },
                    { type: 'cctv1', channel: 4 },
                    { type: 'cctv2', channel: 3 },
                    { type: 'cctv2', channel: 4 },
                    { type: 'cctv1', channel: 5 },
                    { type: 'cctv1', channel: 6 }
                ];
            }
            await startMultiCameras(multiCameraConfigs);
        });
        
        // Stop all cameras
        document.getElementById('stop-multi-camera').addEventListener('click', async () => {
            try {
                const response = await fetch('/api/multi_cameras/stop', { method: 'POST' });
                const data = await response.json();
                
                if (data.success) {
                    multiCameraActive = false;
                    document.getElementById('multi-camera-grid').classList.add('hidden');
                    document.getElementById('multi-camera-status').textContent = 'All cameras stopped';
                    updateStatus('üõë All cameras stopped');
                }
            } catch (error) {
                console.error('Error stopping cameras:', error);
            }
        });
        
        // Start multi-cameras function
        async function startMultiCameras(configs) {
            try {
                updateStatus('üöÄ Starting ' + configs.length + ' cameras...');
                
                const response = await fetch('/api/multi_cameras/start', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ cameras: configs })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    multiCameraActive = true;
                    document.getElementById('multi-camera-status').textContent = 
                        `‚úÖ ${data.active_cameras} cameras active`;
                    updateStatus(data.message, 'success');
                    
                    // Show grid and start receiving frames
                    document.getElementById('multi-camera-grid').classList.remove('hidden');
                    startMultiCameraStream();
                } else {
                    updateStatus('‚ùå ' + data.message, 'error');
                }
            } catch (error) {
                console.error('Error starting multi-cameras:', error);
                updateStatus('‚ùå Failed to start cameras', 'error');
            }
        }
        
        // Start receiving multi-camera stream
        function startMultiCameraStream() {
            const eventSource = new EventSource('/api/multi_cameras/frames');
            const grid = document.getElementById('multi-camera-grid');
            
            eventSource.onmessage = (event) => {
                try {
                    const frames = JSON.parse(event.data);
                    
                    // Update or create camera feed elements
                    Object.keys(frames).forEach(cameraId => {
                        let imgElement = document.getElementById('feed-' + cameraId);
                        if (!imgElement) {
                            imgElement = document.createElement('img');
                            imgElement.id = 'feed-' + cameraId;
                            imgElement.style.cssText = 'width: 100%; height: auto; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.3);';
                            grid.appendChild(imgElement);
                        }
                        imgElement.src = 'data:image/jpeg;base64,' + frames[cameraId];
                    });
                } catch (error) {
                    console.error('Error processing frames:', error);
                }
            };
            
            eventSource.onerror = () => {
                console.log('Multi-camera stream closed');
                eventSource.close();
            };
        }
        
    </script>
</body>
</html>